<main id="skip-header-target" role="main">
  <section class="py-3 d-flex justify-content-center">
    <div class="container-fluid mx-3">
      <div class="col">
        <!-- Top headings-->
        <div class="row pb-1 justify-content-between">
          <div class="col pl-6"><h2><%= render partial: 'shared/idbadge', locals: {:result => @result, :props => { :full => true} } %></h2></div>
        </div>
        <div class="row pb-1 justify-content-between hidden">
          <!-- Page actions probably not needed for subjects-->
          <div class="col"><%= render partial: 'shared/page_actions', locals: {:record => @result, :title => @result.display_string, :url => request.fullpath } %></div>
        </div>
        <div class="row pb-1 justify-content-between">
          <div class="col pl-6"><span class="inline-label clear"><strong><%= t('enumeration_names.subject_source') %></strong>: </span><%= t("enumerations.subject_source.#{@result['json']['source']}" ) %></div>
        </div>

        <% if !@result.dates.blank? %>
          <% render partial: 'shared/dates', locals: {:dates => @result.dates} %>
        <% end %>

        <% if !@result['json']['component_id'].blank? %>
          <span class='component'><%= t(component._singular) %>: <%= @result['json']['component_id'] %></span>
        <% end %>
        <% if !@result['json']['ref_id'].blank? %>
          <span class='ref_id'>[Ref. ID: <%= @result['json']['ref_id'] %>]</span>
        <% end %>
        <% if @result['json']['scope_note'].present? %>
          <div class="row pb-1 justify-content-between">
            <div class="col pl-6">
              <span class="inline-label"><strong><%= t('scope_note') %>
                : </strong></span> <%= process_mixed_content(@result['json']['scope_note']).html_safe %>
            </div>
          </div>
        <% end %>
        <%= render partial: 'shared/display_notes' %>
      </div>

      <!-- Table rows -->
      <div class="row matrix-gutter justify-content-center">
        <div class="col-8">
          <% unless @results.blank? || @results['total_hits'] == 0 %>
            <h3 class="pl-2"><%= t('found', {:count => @results['total_hits'], :type => @results['total_hits'] == 1? t('coll_obj._singular') : t('coll_obj._plural')}) %>:</h3>
            <hr>
            <table class="table">
              <tbody>
              <% @results.records.each do |result| %>
                <%= render partial: 'subjects/result', locals: {:result => result, :props => {:full => false}} %>
              <% end %>
              </tbody>
            </table>
            <%= render partial: 'shared/pagination', locals: {:pager  => @pager}  %>
          <% end %>
        </div>

        <!-- Side bar-->
        <div class="col-3">
          <h3><%= t('more_about') %> '<%= @result.display_string %>'</h3>

          <div class="acc_holder clear">
            <div class="accordion-group" role="tablist" id="accordion-01">
              <% if !(terms = ASUtils.wrap(@result['json']['terms'])).empty? %>
                <% x = render partial: 'subjects/terms', locals: {:terms =>  terms, :list_clss => 'terms'} %>
                <%= render partial: 'shared/accordion_panel', locals: {:p_title => t('subject_term_type'), :p_id => 'subject_terms', :p_body => x} %>
              <% end %>
              <% unless @result.external_documents.blank? %>
                <% x = render partial: 'shared/present_list_external_docs', locals: {:list =>  @result.external_documents, :list_clss => 'external_docs'} %>
                <%= render partial: 'shared/accordion_panel', locals: {:p_title => t('external_docs'), :p_id => 'ext_doc_list', :p_body => x} %>
              <% end %>
            </div>
          </div>

          <br>

          <div id="subject-facets" <% if @facets.blank? %>class="hidden"<% end %>>
            <h2 class="h4">Filter by:</h2>
            <div class="bg-light p-3">
              <%= render partial: 'subjects/only_facets' %>
            </div>
          </div>
        </div>
      </div>
      <!-- .row -->
    </div>
    <!-- .container -->
  </section>
</main>